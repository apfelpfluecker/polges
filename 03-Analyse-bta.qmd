# Analyseebene 2: Bundestagsanträge

```{r}
#| label: setup
#| include: false
#| echo: false
#| waring: false
#| error: false

source("_common.R")
library(ggpubr)

```

Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

```{r}
#| label: tbl-bta
#| echo: false
#| tbl-cap: Bundestagsanträge der Fraktionen/Gruppen
#| waring: false
#| error: false
#| eval: false #Code nicht ausführen, nur in Ausagabe

bta <- readRDS("data/btantraege.Rds")
bta_sum <- readRDS("data/btantraege_sum.Rds")

#barplot(as.vector(bta_sum$antr_gendern_gesamt))

#kable(round(bta_sum,3))

bta_sum$party <- c(1,2,3,4,5,6,7,8,9)

bta_sum <- bta_sum %>%  
  sjlabelled::set_labels(party, labels = c("SPD" = 1, "Union" = 2, "Grüne" = 3, "FDP" = 4, "AfD" = 5, "Linke" = 6, "BSW" = 7, "BuReg" = 8, "BMs" = 9))

bta_tbl <- as_tibble(round(bta_sum,3)) %>% 
  sjlabelled::as_label(party)
  

header <- c("SPD", "Union", "Grüne", "FDP", "AfD", "Linke", "BSW", "BuReg", "BMs")

bta_tbl %>% 
  kableExtra::kable(
    booktabs = TRUE, 
    align = c('l', rep('r',2)), # die 10 steht dafür, dass 10 weitere Spalten alle rechtsbündig sind bzw. wären
    #linesep = "", # ohne diese Zeile, macht knitr alle 5 Zeilen einen kleinen Abstand, der oft kaum Sinn macht
    col.names = c("Anträge gesamt", "Anträge geS", "Anträge gesamt (in %)", "Anträge geS (in %)", "Anträge geS/gesamt"), # Damit können die Überschriften neu gemacht werden
  ) %>% 
  kableExtra::add_header_above(header) %>% 
  kableExtra::footnote(general = "Hier könnten/sollten Sie einen allgemeinen Hinweis oder eine kleine Erläuterung zur Tabelle geben.",
            general_title = "", # damit Kable unten nicht "Note" schreibt
           threeparttable = T # damit längere Fussnoten umgebrochen werden
           ) %>% 
  kableExtra::kable_styling()

```
